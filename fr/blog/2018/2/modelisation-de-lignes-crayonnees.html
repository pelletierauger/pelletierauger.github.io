<!DOCTYPE html>
<html><head>
        <meta charset="UTF-8">
        <title>Guillaume Pelletier-Auger - Modélisation de lignes crayonnées</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=4, user-scalable=yes">
        <link href="../../../../style/style.css" rel="stylesheet" type="text/css">
        <link href="../../../../style/truchet.css" rel="stylesheet" type="text/css">
        
        <link href="https://fonts.googleapis.com/css?family=Inconsolata|EB+Garamond" rel="stylesheet">
        <link href="../../../../style/code.css" rel="stylesheet" type="text/css">
    <style id="MathJax_CHTML_styles">.mjx-chtml {display: inline-block; line-height: 0; text-indent: 0; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; letter-spacing: normal; word-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; margin: 0; padding: 1px 0}
.MJXc-display {display: block; text-align: center; margin: 1em 0; padding: 0}
.mjx-chtml[tabindex]:focus, body :focus .mjx-chtml[tabindex] {display: inline-table}
.mjx-full-width {text-align: center; display: table-cell!important; width: 10000em}
.mjx-math {display: inline-block; border-collapse: separate; border-spacing: 0}
.mjx-math * {display: inline-block; -webkit-box-sizing: content-box!important; -moz-box-sizing: content-box!important; box-sizing: content-box!important; text-align: left}
.mjx-numerator {display: block; text-align: center}
.mjx-denominator {display: block; text-align: center}
.MJXc-stacked {height: 0; position: relative}
.MJXc-stacked > * {position: absolute}
.MJXc-bevelled > * {display: inline-block}
.mjx-stack {display: inline-block}
.mjx-op {display: block}
.mjx-under {display: table-cell}
.mjx-over {display: block}
.mjx-over > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-under > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-stack > .mjx-sup {display: block}
.mjx-stack > .mjx-sub {display: block}
.mjx-prestack > .mjx-presup {display: block}
.mjx-prestack > .mjx-presub {display: block}
.mjx-delim-h > .mjx-char {display: inline-block}
.mjx-surd {vertical-align: top}
.mjx-mphantom * {visibility: hidden}
.mjx-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 2px 3px; font-style: normal; font-size: 90%}
.mjx-annotation-xml {line-height: normal}
.mjx-menclose > svg {fill: none; stroke: currentColor}
.mjx-mtr {display: table-row}
.mjx-mlabeledtr {display: table-row}
.mjx-mtd {display: table-cell; text-align: center}
.mjx-label {display: table-row}
.mjx-box {display: inline-block}
.mjx-block {display: block}
.mjx-span {display: inline}
.mjx-char {display: block; white-space: pre}
.mjx-itable {display: inline-table; width: auto}
.mjx-row {display: table-row}
.mjx-cell {display: table-cell}
.mjx-table {display: table; width: 100%}
.mjx-line {display: block; height: 0}
.mjx-strut {width: 0; padding-top: 1em}
.mjx-vsize {width: 0}
.MJXc-space1 {margin-left: .167em}
.MJXc-space2 {margin-left: .222em}
.MJXc-space3 {margin-left: .278em}
.mjx-ex-box-test {position: absolute; width: 1px; height: 60ex}
.mjx-line-box-test {display: table!important}
.mjx-line-box-test span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MJXc-TeX-unknown-R {font-family: monospace; font-style: normal; font-weight: normal}
.MJXc-TeX-unknown-I {font-family: monospace; font-style: italic; font-weight: normal}
.MJXc-TeX-unknown-B {font-family: monospace; font-style: normal; font-weight: bold}
.MJXc-TeX-unknown-BI {font-family: monospace; font-style: italic; font-weight: bold}
.MJXc-TeX-ams-R {font-family: MJXc-TeX-ams-R,MJXc-TeX-ams-Rw}
.MJXc-TeX-cal-B {font-family: MJXc-TeX-cal-B,MJXc-TeX-cal-Bx,MJXc-TeX-cal-Bw}
.MJXc-TeX-frak-R {font-family: MJXc-TeX-frak-R,MJXc-TeX-frak-Rw}
.MJXc-TeX-frak-B {font-family: MJXc-TeX-frak-B,MJXc-TeX-frak-Bx,MJXc-TeX-frak-Bw}
.MJXc-TeX-math-BI {font-family: MJXc-TeX-math-BI,MJXc-TeX-math-BIx,MJXc-TeX-math-BIw}
.MJXc-TeX-sans-R {font-family: MJXc-TeX-sans-R,MJXc-TeX-sans-Rw}
.MJXc-TeX-sans-B {font-family: MJXc-TeX-sans-B,MJXc-TeX-sans-Bx,MJXc-TeX-sans-Bw}
.MJXc-TeX-sans-I {font-family: MJXc-TeX-sans-I,MJXc-TeX-sans-Ix,MJXc-TeX-sans-Iw}
.MJXc-TeX-script-R {font-family: MJXc-TeX-script-R,MJXc-TeX-script-Rw}
.MJXc-TeX-type-R {font-family: MJXc-TeX-type-R,MJXc-TeX-type-Rw}
.MJXc-TeX-cal-R {font-family: MJXc-TeX-cal-R,MJXc-TeX-cal-Rw}
.MJXc-TeX-main-B {font-family: MJXc-TeX-main-B,MJXc-TeX-main-Bx,MJXc-TeX-main-Bw}
.MJXc-TeX-main-I {font-family: MJXc-TeX-main-I,MJXc-TeX-main-Ix,MJXc-TeX-main-Iw}
.MJXc-TeX-main-R {font-family: MJXc-TeX-main-R,MJXc-TeX-main-Rw}
.MJXc-TeX-math-I {font-family: MJXc-TeX-math-I,MJXc-TeX-math-Ix,MJXc-TeX-math-Iw}
.MJXc-TeX-size1-R {font-family: MJXc-TeX-size1-R,MJXc-TeX-size1-Rw}
.MJXc-TeX-size2-R {font-family: MJXc-TeX-size2-R,MJXc-TeX-size2-Rw}
.MJXc-TeX-size3-R {font-family: MJXc-TeX-size3-R,MJXc-TeX-size3-Rw}
.MJXc-TeX-size4-R {font-family: MJXc-TeX-size4-R,MJXc-TeX-size4-Rw}
@font-face {font-family: MJXc-TeX-ams-R; src: local('MathJax_AMS'), local('MathJax_AMS-Regular')}
@font-face {font-family: MJXc-TeX-ams-Rw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_AMS-Regular.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-B; src: local('MathJax_Caligraphic Bold'), local('MathJax_Caligraphic-Bold')}
@font-face {font-family: MJXc-TeX-cal-Bx; src: local('MathJax_Caligraphic'); font-weight: bold}
@font-face {font-family: MJXc-TeX-cal-Bw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Bold.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Bold.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-R; src: local('MathJax_Fraktur'), local('MathJax_Fraktur-Regular')}
@font-face {font-family: MJXc-TeX-frak-Rw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Regular.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Regular.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-B; src: local('MathJax_Fraktur Bold'), local('MathJax_Fraktur-Bold')}
@font-face {font-family: MJXc-TeX-frak-Bx; src: local('MathJax_Fraktur'); font-weight: bold}
@font-face {font-family: MJXc-TeX-frak-Bw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Bold.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Bold.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-BI; src: local('MathJax_Math BoldItalic'), local('MathJax_Math-BoldItalic')}
@font-face {font-family: MJXc-TeX-math-BIx; src: local('MathJax_Math'); font-weight: bold; font-style: italic}
@font-face {font-family: MJXc-TeX-math-BIw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Math-BoldItalic.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-BoldItalic.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-BoldItalic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-R; src: local('MathJax_SansSerif'), local('MathJax_SansSerif-Regular')}
@font-face {font-family: MJXc-TeX-sans-Rw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Regular.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Regular.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-B; src: local('MathJax_SansSerif Bold'), local('MathJax_SansSerif-Bold')}
@font-face {font-family: MJXc-TeX-sans-Bx; src: local('MathJax_SansSerif'); font-weight: bold}
@font-face {font-family: MJXc-TeX-sans-Bw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Bold.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Bold.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-I; src: local('MathJax_SansSerif Italic'), local('MathJax_SansSerif-Italic')}
@font-face {font-family: MJXc-TeX-sans-Ix; src: local('MathJax_SansSerif'); font-style: italic}
@font-face {font-family: MJXc-TeX-sans-Iw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Italic.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Italic.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-script-R; src: local('MathJax_Script'), local('MathJax_Script-Regular')}
@font-face {font-family: MJXc-TeX-script-Rw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Script-Regular.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Script-Regular.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-type-R; src: local('MathJax_Typewriter'), local('MathJax_Typewriter-Regular')}
@font-face {font-family: MJXc-TeX-type-Rw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Typewriter-Regular.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Typewriter-Regular.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Typewriter-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-R; src: local('MathJax_Caligraphic'), local('MathJax_Caligraphic-Regular')}
@font-face {font-family: MJXc-TeX-cal-Rw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Regular.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-B; src: local('MathJax_Main Bold'), local('MathJax_Main-Bold')}
@font-face {font-family: MJXc-TeX-main-Bx; src: local('MathJax_Main'); font-weight: bold}
@font-face {font-family: MJXc-TeX-main-Bw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Main-Bold.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-I; src: local('MathJax_Main Italic'), local('MathJax_Main-Italic')}
@font-face {font-family: MJXc-TeX-main-Ix; src: local('MathJax_Main'); font-style: italic}
@font-face {font-family: MJXc-TeX-main-Iw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Main-Italic.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-R; src: local('MathJax_Main'), local('MathJax_Main-Regular')}
@font-face {font-family: MJXc-TeX-main-Rw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Main-Regular.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-I; src: local('MathJax_Math Italic'), local('MathJax_Math-Italic')}
@font-face {font-family: MJXc-TeX-math-Ix; src: local('MathJax_Math'); font-style: italic}
@font-face {font-family: MJXc-TeX-math-Iw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Math-Italic.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size1-R; src: local('MathJax_Size1'), local('MathJax_Size1-Regular')}
@font-face {font-family: MJXc-TeX-size1-Rw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Size1-Regular.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size2-R; src: local('MathJax_Size2'), local('MathJax_Size2-Regular')}
@font-face {font-family: MJXc-TeX-size2-Rw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Size2-Regular.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size3-R; src: local('MathJax_Size3'), local('MathJax_Size3-Regular')}
@font-face {font-family: MJXc-TeX-size3-Rw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Size3-Regular.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size4-R; src: local('MathJax_Size4'), local('MathJax_Size4-Regular')}
@font-face {font-family: MJXc-TeX-size4-Rw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Size4-Regular.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf') format('opentype')}
</style></head><body>
    <nav>
        <h1><a href="../../../../fr/">Guillaume <span class="nobreak">Pelletier-Auger</span></a></h1>
        <ul>
            <li><a href="../../../../fr/">Projets</a></li>
            <li class="selected"><a href="../../../../fr/blog/">Blog</a></li>
            <li><a href="../../../../fr/a-propos.html">À propos</a></li>
            <li><a href="../../../../en/blog/2018/2/modeling-pencil-strokes.html">Fr → En</a></li>
        </ul>
    </nav>
    
            <article>
                <h2 class="with-date">Modélisation de lignes crayonnées
</h2><div class="description">
                    Premières ébauches de méthodes algorithmiques pour imiter l’apparence du dessin.

            </div>
                <div class="date">3 février 2018</div>
                

<img src="../../../../images/pencil/circles.jpg">

<p class="article-top">
    <span class="small-caps">L’an dernier</span>, j’ai écrit un court programme pour modéliser des lignes dessinées au crayon. Le projet est encore embryonnaire et je veux continuer à le faire avancer sporadiquement. Je commence aujourd’hui par une relecture du code écrit l’an dernier et une synthèse des idées qu’il contient.
</p>
<p>
    L’image ci-dessus a été générée avec ce programme. Elle contient plusieurs problèmes qu’il me faudra résoudre. Tout d’abord, les lignes démarrent et s’arrêtent abruptement; elles n’ont pas cette pointe naturelle que l’on s’attendrait à voir aux extrémités d’un trait dessiné à la main. Cela crée une brisure très artificielle dans le tracé des cercles. Ensuite, les lignes d’épaisseur moyenne sont les seules qui fonctionnent
        <label for="crayon" class="margin-toggle">—
        </label>
        <input type="checkbox" id="crayon" class="margin-toggle">
        <span class="marginnote-left"><span class="italic8">Mais <span class="nobreak">est-ce</span><br>du graphite,<br>du fusain,<br>du crayon<br>Conté…&nbsp;?<br></span></span> bien visuellement, les plus fines et les plus grasses ayant un air peu naturel. Dernièrement, et c’est le plus grand problème, j’ai l’impression que la variation de l’épaisseur du trait est identique pour toutes les lignes dans le quadrant inférieur droit de chaque cercle. Il y a une <span class="italic">régularité désagréable</span> qui semble s’être glissée dans cet algorithme qui cherche à simuler le caractère imprévisible du crayon. De mauvais calculs trigonométriques se terrent peut-être là-dessous.
</p>

<h3>Distribution normale et variations <span class="nobreak">semi-aléatoires</span></h3>

<p class="noindent">
    <span class="small-caps">L’idée centrale</span> du programme consiste à utiliser une distribution normale pour simuler la forme d’une mine de crayon ainsi que ses frottements sur le papier. Tout d’abord, notre distribution normale est calculée avec l’équation suivante&nbsp;:
</p>

<div class="math"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-1-Frame" class="mjx-chtml" style="text-align: center;"><span id="MJXc-Node-4046" class="mjx-math"><span id="MJXc-Node-4047" class="mjx-mrow"><span id="MJXc-Node-4048" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-4049" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span id="MJXc-Node-4050" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 3.328em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 3.328em; top: -1.368em;"><span id="MJXc-Node-4051" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span><span class="mjx-denominator" style="width: 3.328em; bottom: -1.15em;"><span id="MJXc-Node-4052" class="mjx-msqrt"><span class="mjx-box" style="padding-top: 0.045em;"><span class="mjx-surd"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.519em; padding-bottom: 0.519em;">√</span></span><span class="mjx-box" style="padding-top: 0.124em; border-top: 1px solid;"><span id="MJXc-Node-4053" class="mjx-mrow"><span id="MJXc-Node-4054" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">π</span></span><span id="MJXc-Node-4055" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.298em;">×</span></span><span id="MJXc-Node-4056" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 3.328em;" class="mjx-line"></span></span><span style="height: 2.518em; vertical-align: -1.15em;" class="mjx-vsize"></span></span><span id="MJXc-Node-4057" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.298em;">×</span></span><span id="MJXc-Node-4058" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-4059" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2.71828</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.73em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4060" class="mjx-texatom" style=""><span id="MJXc-Node-4061" class="mjx-mrow"><span id="MJXc-Node-4062" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.75em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 83.3%; width: 2.1em; top: -1.733em;"><span id="MJXc-Node-4063" class="mjx-mrow" style=""><span id="MJXc-Node-4064" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span id="MJXc-Node-4065" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4066" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span><span class="mjx-sup" style="vertical-align: 0.363em; padding-left: 0px; padding-right: 0.05em;"><span id="MJXc-Node-4067" class="mjx-texatom"><span id="MJXc-Node-4068" class="mjx-mrow"><span id="MJXc-Node-4069" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 83.3%; width: 2.1em; bottom: -0.688em;"><span id="MJXc-Node-4070" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span style="border-bottom: 1px solid; top: -0.296em; width: 1.75em;" class="mjx-line"></span></span><span style="height: 2.017em; vertical-align: -0.573em;" class="mjx-vsize"></span></span></span></span></span></span></span></span></span></span></div>

<p class="noindent">
    Cette équation produit la courbe ci-dessous&nbsp;:
</p>
<p>
    <img class="abcd" src="../../../../images/pencil/normal-distribution.png">
</p>
<p class="noindent">
    Cette colline représente donc l’extrémité de la mine du crayon (on peut ignorer les parties horizontales, qui ne seront pas utilisées). L’axe des <span id="MathJax-Element-2-Frame" class="mjx-chtml"><span id="MJXc-Node-4071" class="mjx-math"><span id="MJXc-Node-4072" class="mjx-mrow"><span id="MJXc-Node-4073" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span></span></span> de la courbe représente le taux de probabilité qu’une particule de la mine soit déposée sur le papier.
</p>
<p>
    Une vraie mine de crayon, cependant, n’est jamais aussi lisse et régulière que cette colline. Au niveau microscopique,
        <label for="irregularites" class="margin-toggle">—
        </label>
        <input type="checkbox" id="irregularites" class="margin-toggle">
        <span class="marginnote-left"><span class="italic8">Accueillir<br>l’irrégulier.</span></span>la mine autant que le papier sont fragmentés comme des chaînes de montagnes. On peut s’imaginer qu’à mesure que le crayon est traîné sur le papier, sa mine vacille&nbsp;; elle change d’angle par rapport au papier&nbsp;; ses différentes aspérités sont appuyées sur la feuille à divers moments et à des niveaux de pression variés.
</p>
<p>
    Afin d’obtenir une mine de crayon irrégulière, les valeurs obtenues par l’équation de la distribution normale sont altérées par du bruit de Perlin. Voici à quoi ressemble notre mine de crayon maintenant&nbsp;:
</p>
<p>
    <img class="abcd" src="../../../../images/pencil/normal-distribution-perlin.gif">
</p>
<p class="noindent">
    Maintenant,
        <label for="dessiner" class="margin-toggle">—
        </label>
        <input type="checkbox" id="dessiner" class="margin-toggle">
        <span class="marginnote-left"><span class="italic8">Dessiner<br>une ligne.</span></span> il suffit de déplacer cette courbe fragmentée sur le plan et de dessiner des points noirs ou gris aux endroits où elle passe. La valeur <span id="MathJax-Element-3-Frame" class="mjx-chtml"><span id="MJXc-Node-4074" class="mjx-math"><span id="MJXc-Node-4075" class="mjx-mrow"><span id="MJXc-Node-4076" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span></span></span> de la courbe déterminera la luminosité des points déposés&nbsp;: plus la valeur <span id="MathJax-Element-4-Frame" class="mjx-chtml"><span id="MJXc-Node-4077" class="mjx-math"><span id="MJXc-Node-4078" class="mjx-mrow"><span id="MJXc-Node-4079" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span></span></span> est haute, plus le point dessiné est sombre. Le mode de mélange <span class="inline-code">blendMode(DARKEST)</span> de <span class="lnum">p5.js</span> contribue aussi beaucoup à l’apparence finale de la ligne&nbsp;: chaque point déposé n’apparaît que s’il est plus foncé que le point qui est dessous.
</p>
<img src="../../../../images/pencil/fat-line.gif">
<p class="noindent">
    J’ai inclus ci-dessous le code source du programme tel qu’il existe en ce moment. J’ai de nombreuses idées pour le modifier et l’améliorer (<a href="#notes-eparses">détaillées plus bas</a>). En fait, il est certain que je vais tout réécrire. Vous pouvez aussi consulter <a href="https://github.com/pelletierauger/Hilma">le code source sur GitHub</a>. Il est distribué librement avec une <a href="http://www.apache.org/licenses/LICENSE-2.0.txt">licence Apache <span class="lnum">2.0</span></a>.
</p>

<div class="codebox"><pre><code><span class="hljs-keyword">var</span> looping<span class="hljs-punctuation"> = </span><span class="hljs-literal">true</span>;
<span class="hljs-keyword">var</span> exporting<span class="hljs-punctuation"> = </span><span class="hljs-literal">false</span>;
<span class="hljs-keyword">var</span> arr<span class="hljs-punctuation"> = </span>[];
<span class="hljs-keyword">var</span> radiusAugmenter<span class="hljs-punctuation"> = </span><span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> graphiteWeight<span class="hljs-punctuation"> = </span><span class="hljs-number">1</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setup</span>(<span class="hljs-params"></span>) </span>{
    createCanvas(windowWidth, windowHeight);
    background(<span class="hljs-number">255</span>);
    noStroke();
    frameRate(<span class="hljs-number">1</span>);
    blendMode(DARKEST);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">draw</span>(<span class="hljs-params"></span>) </span>{
    translate(width<span class="hljs-punctuation"> / </span><span class="hljs-number">2</span>, height<span class="hljs-punctuation"> / </span><span class="hljs-number">2</span>);
    <span class="hljs-keyword">var</span> total<span class="hljs-punctuation"> = </span><span class="hljs-number">100</span>;
    <span class="hljs-keyword">var</span> increment<span class="hljs-punctuation"> = </span>TWO_PI<span class="hljs-punctuation"> / </span>total;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i<span class="hljs-punctuation"> = </span><span class="hljs-number">0</span>; i<span class="hljs-punctuation"> &lt; </span>TWO_PI<span class="hljs-punctuation"> + </span>increment; i <span class="hljs-punctuation">+=</span> increment) {
        <span class="hljs-keyword">var</span> x<span class="hljs-punctuation"> = </span>cos(i)<span class="hljs-punctuation"> * </span>(<span class="hljs-number">50</span><span class="hljs-punctuation"> + </span>radiusAugmenter);
        <span class="hljs-keyword">var</span> y<span class="hljs-punctuation"> = </span>sin(i)<span class="hljs-punctuation"> * </span>(<span class="hljs-number">50</span><span class="hljs-punctuation"> + </span>radiusAugmenter);
        <span class="hljs-keyword">var</span> vec<span class="hljs-punctuation"> = </span>createVector(x, y);
        arr<span class="hljs-punctuation">.</span>push(vec);
    }
    drawGraphite(arr);
    <span class="hljs-keyword">if</span> (exporting) {
        frameExport();
    }
    radiusAugmenter <span class="hljs-punctuation">+=</span> <span class="hljs-number">50</span>;
    graphiteWeight <span class="hljs-punctuation">+=</span> <span class="hljs-number">1</span>;
    arr<span class="hljs-punctuation"> = </span>[];
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">drawGraphite</span>(<span class="hljs-params">h</span>) </span>{
    <span class="hljs-keyword">var</span> drawCount<span class="hljs-punctuation"> = </span><span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j<span class="hljs-punctuation"> = </span><span class="hljs-number">0</span>; j<span class="hljs-punctuation"> &lt; </span>h<span class="hljs-punctuation">.</span>length<span class="hljs-punctuation"> - </span><span class="hljs-number">1</span>; j<span class="hljs-punctuation">++</span>) {
        <span class="hljs-keyword">if</span> (h[j<span class="hljs-punctuation"> + </span><span class="hljs-number">1</span>]) {
            <span class="hljs-keyword">var</span> v1<span class="hljs-punctuation"> = </span>h[j];
            <span class="hljs-keyword">var</span> v2<span class="hljs-punctuation"> = </span>h[j<span class="hljs-punctuation"> + </span><span class="hljs-number">1</span>];
            <span class="hljs-keyword">var</span> hypotenuse<span class="hljs-punctuation"> = </span>dist(v1<span class="hljs-punctuation">.</span>x, v1<span class="hljs-punctuation">.</span>y, v2<span class="hljs-punctuation">.</span>x, v2<span class="hljs-punctuation">.</span>y);
            <span class="hljs-keyword">var</span> angle<span class="hljs-punctuation"> = </span>atan2(v2<span class="hljs-punctuation">.</span>y<span class="hljs-punctuation"> - </span>v1<span class="hljs-punctuation">.</span>y, v2<span class="hljs-punctuation">.</span>x<span class="hljs-punctuation"> - </span>v1<span class="hljs-punctuation">.</span>x);
            push();
            translate(v1<span class="hljs-punctuation">.</span>x, v1<span class="hljs-punctuation">.</span>y);
            rotate(angle<span class="hljs-punctuation"> + </span>PI<span class="hljs-punctuation"> / </span><span class="hljs-number">2</span>);
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i<span class="hljs-punctuation"> = </span><span class="hljs-number">0</span>; i<span class="hljs-punctuation"> &lt; </span>hypotenuse; i<span class="hljs-punctuation">++</span>) {
                translate(<span class="hljs-number">0</span>, <span class="hljs-number">-1</span>);
                drawGraphiteSegment(drawCount);
                drawCount<span class="hljs-punctuation">++</span>;
            }
            pop();
        }
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">drawGraphiteSegment</span>(<span class="hljs-params">t</span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i<span class="hljs-punctuation"> = </span><span class="hljs-number">0</span>; i<span class="hljs-punctuation"> &lt; </span><span class="hljs-number">10</span>; i <span class="hljs-punctuation">+=</span> <span class="hljs-number">0.12</span>) {
        <span class="hljs-keyword">var</span> x<span class="hljs-punctuation"> = </span>i<span class="hljs-punctuation"> - </span><span class="hljs-number">5</span>;
        <span class="hljs-keyword">var</span> y<span class="hljs-punctuation"> = </span><span class="hljs-punctuation">-</span>(<span class="hljs-number">1</span><span class="hljs-punctuation"> / </span>sqrt(TWO_PI))<span class="hljs-punctuation"> * </span>pow(<span class="hljs-number">2.71828</span>, <span class="hljs-punctuation">-</span>pow(x, <span class="hljs-number">2</span>)<span class="hljs-punctuation"> / </span><span class="hljs-number">2</span>);
        <span class="hljs-keyword">var</span> noiseValue<span class="hljs-punctuation"> = </span>i<span class="hljs-punctuation"> + </span>t<span class="hljs-punctuation"> / </span><span class="hljs-number">100</span>;
        <span class="hljs-keyword">var</span> n<span class="hljs-punctuation"> = </span>noise(noiseValue)<span class="hljs-punctuation"> / </span><span class="hljs-number">200</span>;
        n <span class="hljs-punctuation">+=</span> noise(noiseValue)<span class="hljs-punctuation"> * </span><span class="hljs-number">2</span><span class="hljs-punctuation"> * </span>y;
        y <span class="hljs-punctuation">+=</span> n;
        y <span class="hljs-punctuation">*=</span> <span class="hljs-number">300</span>;
        <span class="hljs-keyword">var</span> n2<span class="hljs-punctuation"> = </span>noise(t<span class="hljs-punctuation"> / </span><span class="hljs-number">50</span>);
        <span class="hljs-keyword">var</span> n3<span class="hljs-punctuation"> = </span>noise(<span class="hljs-number">100</span><span class="hljs-punctuation"> + </span>t<span class="hljs-punctuation"> / </span><span class="hljs-number">50</span>);
        <span class="hljs-keyword">var</span> lineWidth<span class="hljs-punctuation"> = </span>graphiteWeight;
        x <span class="hljs-punctuation">*=</span> lineWidth;
        <span class="hljs-keyword">if</span> (x<span class="hljs-punctuation"> &lt;= </span><span class="hljs-number">0</span>) {
            x <span class="hljs-punctuation">*=</span> n2;
        } <span class="hljs-keyword">else</span> {
            x <span class="hljs-punctuation">*=</span> n3;
        }
        <span class="hljs-keyword">var</span> mapCrayon<span class="hljs-punctuation"> = </span>map(y, <span class="hljs-number">-200</span>, <span class="hljs-number">0</span>, <span class="hljs-number">80</span>, <span class="hljs-number">255</span>);
        mapCrayon<span class="hljs-punctuation"> = </span>constrain(mapCrayon, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>);
        fill(round(mapCrayon));
        push();
        <span class="hljs-keyword">var</span> nGrain<span class="hljs-punctuation"> = </span>noise(t)<span class="hljs-punctuation"> * </span>lineWidth<span class="hljs-punctuation"> * </span><span class="hljs-number">1</span>;
        translate(random(nGrain), random(nGrain));
        ellipse(x, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>);
        pop();
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">keyPressed</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (keyCode<span class="hljs-punctuation"> <span class="hljs-punctuation">==</span>= </span><span class="hljs-number">32</span>) {
        <span class="hljs-keyword">if</span> (looping) {
            noLoop();
            looping<span class="hljs-punctuation"> = </span><span class="hljs-literal">false</span>;
        } <span class="hljs-keyword">else</span> {
            loop();
            looping<span class="hljs-punctuation"> = </span><span class="hljs-literal">true</span>;
        }
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">frameExport</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> formattedFrameCount<span class="hljs-punctuation"> = </span><span class="hljs-string">""</span><span class="hljs-punctuation"> + </span>frameCount;
    <span class="hljs-keyword">while</span> (formattedFrameCount<span class="hljs-punctuation">.</span>length<span class="hljs-punctuation"> &lt; </span><span class="hljs-number">5</span>) {
        formattedFrameCount<span class="hljs-punctuation"> = </span><span class="hljs-string">"0"</span><span class="hljs-punctuation"> + </span>formattedFrameCount;
    }
    save(<span class="hljs-string">"grooves"</span><span class="hljs-punctuation"> + </span>formattedFrameCount<span class="hljs-punctuation"> + </span><span class="hljs-string">".png"</span>);
}</code></pre></div>

<a name="notes-eparses"><h3>Notes éparses</h3></a>

<p class="noindent">
    <span class="small-caps">En fait</span>, ce qu’il me faudrait, c’est une classe <span class="inline-code">Line</span>. N’importe quel procédé pourrait créer une nouvelle instance de <span class="inline-code">Line</span> et lui envoyer des vecteurs pour ajouter des segments à la ligne dessinée. La classe <span class="inline-code">Line</span> ferait la gestion automatique du bruit&nbsp;: elle s’assurerait que chaque nouveau segment de ligne ajouté soit une suite cohérente avec le dernier segment. Elle devrait aussi gérer les terminaisons — les débuts et fins de lignes. Il faudrait simplement que la méthode <span class="inline-code">Line.drawSegment()</span> reçoive en argument une booléenne nommée <span class="inline-code">end</span>. En recevant un segment terminal, l’instance de <span class="inline-code">Line</span> dessinerait un dernier segment pointu, puis changerait sa propriété booléenne <span class="inline-code">terminated</span> pour <span class="inline-code">true</span>. Le prochain segment dessiné réactiverait la ligne, qui dessinerait un nouveau segment pointu comme segment initial d’une nouvelle ligne. Ou plutôt, est-ce qu’une ligne qui reçoit un segment terminal devrait s’auto-détruire&nbsp;?
</p>
<p>
    Il pourrait aussi être intéressant de séparer le moment où les segments de lignes sont “commandés” par un programme et le moment où ils sont dessinés. Une instance de <span class="inline-code">Line</span> pourrait avoir une liste de segments à dessiner, et lorsqu’elle en reçoit de nouveaux, elle pourrait simplement les ajouter à cette liste. La méthode s’appelerait <span class="inline-code">Line.addSegment()</span>. Une autre méthode appelée <span class="inline-code">Line.drawSegment()</span> dessinerait simplement le prochain segment dans la liste. Ainsi, des milliers de segments pourraient être ajoutés dans un seul frame d’animation, mais au lieu d’être tous dessinés simultanément (ce qui ralentirait péniblement le système), ils seraient dessinés dans plusieurs frames d’animation consécutifs.
</p>
<p>
    Je pourrais me servir de la fonction <span class="inline-code">randomGaussian()</span> qui est fournie avec <span class="lnum">p5.js</span> et qui crée également une distribution normale — m’en servir au lieu de l’équation présentement utilisée.
</p>
<p>
    Le code de l’an dernier utilise du bruit de Perlin unidimensionnel pour fragmenter la distribution normale alors qu’il me faudrait clairement utiliser du bruit bidimensionnel.
</p>
<p>
    Idée improbable&nbsp;: toujours en restant dans des mathématiques à deux dimensions, on pourrait imaginer une modélisation de la circonférence complète de la mine. Ce serait une courbe brisée par du bruit mais qui se refermerait sur elle-même. On pourrait faire tourner la mine selon l’angle de déplacement du crayon. On pourrait même modéliser la dégradation progressive de la mine.
</p>

<h3>Sources</h3>

<p class="noindent">
    <span class="small-caps">Mes réflexions</span> pour ce projet ont démarrées avec la lecture de l’article <span class="italic"><a href="http://webhome.cs.uvic.ca/~blob/publications/zainabcag.pdf">Automatically Mimicking Unique Hand-Drawn Pencil Lines</a></span>, signé par Zainab AlMeraj, Brian Wyvill, Tobias Isenberg, Amy A. Gooch et Richard Guy. Je n’ai au final pas utilisé les méthodes détaillées dans cet article mais il constitue néanmoins une lecture intéressante.
</p>


            </article>
            
    <div id="rss-link">
        <a href="https://pelletierauger.com/fr/blog/rss.xml">Flux RSS</a>
    </div>
    <div id="footer">Guillaume Pelletier-Auger — 2016-2025
    </div>
    
    </body></html>